<!DOCTYPE html>
<html>
<head>
    <title>WebRTC Raspberry Pi Camera Stream</title>
</head>
<body>
    <video id="video" autoplay playsinline></video>
    
    <script src="https://webrtc.github.io/adapter/adapter-latest.js"></script>
    <script>
        const video = document.getElementById('video');
        const pc = new RTCPeerConnection();

        pc.ontrack = event => {
            if (event.track.kind === 'video') {
                video.srcObject = event.streams[0];
            }
        };

        pc.addTransceiver('video', {direction: 'recvonly'});

        pc.createOffer()
            .then(offer => pc.setLocalDescription(offer))
            .then(() => {
                // Send the offer to the server
                return fetch('http://192.168.1.101:8080/offer', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        sdp: pc.localDescription.sdp,
                        type: pc.localDescription.type
                    })
                });
            })
            .then(response => response.json())
            .then(answer => pc.setRemoteDescription(answer))
            .catch(e => console.error(e));
    </script>
</body>
</html>